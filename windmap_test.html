<!DOCTYPE html>
<html>
<head>
    <title>ã‚³ãƒ¼ã‚¹ä½œãã‚“-v6.5.6 by Popolo App.com</title>
    <style>
        /* scannable layout */
        body { font-size: 150%; margin: 20px; font-family: sans-serif; }
        h1 { font-size: 1.2em; border-left: 10px solid #007bff; padding-left: 15px; }
        .version-info { font-size: 0.6em; color: #666; margin-left: 10px; }
        
        .control-panel { background: #f8f9fa; padding: 20px; border-radius: 10px; border: 1px solid #ddd; }
        .input-group { margin-bottom: 15px; }
        label { font-weight: bold; display: inline-block; width: 150px; }
        input { font-size: 1.1em; padding: 5px; width: 100px; }
        
        button { 
            padding: 15px 25px; font-size: 1.2em; cursor: pointer; border-radius: 8px; border: none;
            display: block; width: 100%; margin-bottom: 10px; font-weight: bold;
        }
        #resetLocationButton { background-color: #d9534f; color: white; } /* ç¾åœ¨ä½ç½®ãƒªã‚»ãƒƒãƒˆ */
        #resetLocationButton:active { background-color: #c9302c; }
        
        #calcButton { background-color: #007bff; color: white; }
        
        #map { height: 60vh; width: 100%; margin-top: 20px; border: 2px solid #333; }
        .status-msg { font-size: 0.9em; color: #d9534f; font-weight: bold; margin: 10px 0; }
    </style>
</head>
<body>

    <h1>ã‚³ãƒ¼ã‚¹ä½œãã‚“ <span class="version-info">v6.5.6 by Popolo App.com</span></h1>

    <div class="control-panel">
        <button id="resetLocationButton">ğŸ“ ç¾åœ¨ä½ç½®ãƒªã‚»ãƒƒãƒˆ (é«˜ç²¾åº¦å–å¾—)</button>
        <div id="statusMsg" class="status-msg"></div>

        <hr>

        <div class="input-group">
            <label>è§’D (30Â°):</label>
            <input type="number" id="angleD" value="30"> Â°
        </div>
        <div class="input-group">
            <label>è§’B (45Â°):</label>
            <input type="number" id="angleB" value="45"> Â°
        </div>
        <div class="input-group">
            <label>ASè·é›¢:</label>
            <input type="number" id="asDistance" value="100"> m
        </div>

        <button id="calcButton">ã‚³ãƒ¼ã‚¹è¨ˆç®—ãƒ»æç”»</button>
    </div>

    <div id="map"></div>

    <script>
        let map, markerA, circle;
        const API_KEY = "AIzaSyAHhxSJK-IhYiT9XBRwE1MX7DHhghBQQQk"; 

        // é«˜ç²¾åº¦ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å–å¾—é–¢æ•°
        function updateCurrentLocation() {
            const status = document.getElementById('statusMsg');
            status.textContent = "ğŸ“¡ GPSä¿¡å·ã‚’å—ä¿¡ä¸­ï¼ˆé«˜ç²¾åº¦ãƒ¢ãƒ¼ãƒ‰ï¼‰...";

            if (navigator.geolocation) {
                const geoOptions = {
                    enableHighAccuracy: true, // GPSå„ªå…ˆ
                    timeout: 10000,           // 10ç§’å¾…æ©Ÿ
                    maximumAge: 0             // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¸€åˆ‡ä½¿ã‚ãªã„
                };

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const pos = { lat, lng };

                        if (markerA) {
                            markerA.setPosition(pos);
                        } else {
                            markerA = new google.maps.Marker({
                                position: pos,
                                map: map,
                                label: "A",
                                title: "ç¾åœ¨åœ° (Aç‚¹)"
                            });
                        }
                        map.setCenter(pos);
                        map.setZoom(16);
                        status.textContent = "âœ… ç¾åœ¨åœ°ã‚’æœ€æ–°çŠ¶æ…‹ã«æ›´æ–°ã—ã¾ã—ãŸã€‚";
                        setTimeout(() => status.textContent = "", 3000);
                    },
                    (error) => {
                        status.textContent = "âŒ ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
                        console.error(error);
                    },
                    geoOptions
                );
            } else {
                status.textContent = "âŒ ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚";
            }
        }

        function initMap() {
            // åˆæœŸä½ç½®ï¼ˆä»®ï¼šæ²–ç¸„ï¼‰
            const defaultPos = { lat: 26.33, lng: 127.80 };
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 14,
                center: defaultPos
            });

            document.getElementById('resetLocationButton').addEventListener('click', updateCurrentLocation);
            
            // åˆå›èµ·å‹•æ™‚ã«ã‚‚è‡ªå‹•ã§ä¸€åº¦å–å¾—
            updateCurrentLocation();
        }

        // è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ãªã©ã¯é©å®œã“ã“ã«è¿½åŠ 
        document.getElementById('calcButton').addEventListener('click', () => {
            alert("ã‚³ãƒ¼ã‚¹è¨ˆç®—ã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆã“ã“ã«è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ãŒå…¥ã‚Šã¾ã™ï¼‰");
        });

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHhxSJK-IhYiT9XBRwE1MX7DHhghBQQQk&callback=initMap"></script>
</body>
</html>